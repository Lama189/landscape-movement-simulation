<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Результат ландшафта</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f0f0f0;
        }

        .landscape {
            flex-grow: 1;
            display: flex; 
        }

        .landscape > div {
            flex-grow: 1;
            height: 100%;     
            min-height: 600px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Сгенерированный ландшафт</h1>
        <a href="/">Назад к форме</a>
    </header>
    <div class="landscape" id="plot">
        {{ fig_html | safe }}
    </div>

    <script>
    let points = [];

    document.addEventListener("DOMContentLoaded", () => {
        let plot = document.getElementById('plot').children[0]; 

        plot.on('plotly_click', function(data){
            let x = Math.round(data.points[0].x);
            let y = Math.round(data.points[0].y);

            points.push({x, y});
            if (points.length === 1) {
                alert(`Старт выбрано: (${x}, ${y})`);
            }
            if (points.length === 2) {
                alert(`Финиш выбрано: (${x}, ${y})`);

                fetch("/run_pathfinding", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify(points)
                }).then(r => r.text()).then(html => {
                    document.body.innerHTML = html;
                });
            }
        });
    });
    </script>
</body>
</html>
